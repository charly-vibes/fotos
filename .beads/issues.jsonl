{"id":"fotos-1ia","title":"Tracer: Tauri IPC foundation — verify command round-trip","description":"Prove Tauri IPC works end-to-end with a trivial ping/pong command.\n\n**Acceptance criteria:**\n- Add a `ping` Tauri command that returns `\"pong\"`\n- Frontend calls it via `invoke('ping')` on app init\n- Console logs the response, status bar shows 'Backend connected'\n- This validates the JS→Rust→JS pipeline before building real features\n\n**Scope:** ~20 lines Rust, ~10 lines JS. Touches lib.rs, app.js, tauri-bridge module.","status":"closed","priority":1,"issue_type":"task","owner":"charly.vibes@proton.me","created_at":"2026-02-19T20:58:08.38619768-03:00","created_by":"charly vibes","updated_at":"2026-02-20T16:13:35.654831374-03:00","closed_at":"2026-02-20T16:13:35.654831374-03:00","close_reason":"Implemented ping/pong IPC round-trip. Rust command added, frontend wrapper created, app.js calls on init and updates status bar. Compiles successfully."}
{"id":"fotos-1xi","title":"Tracer: Screenshot capture — xcap fullscreen","description":"Minimal screenshot capture: fullscreen only, xcap backend, X11/XWayland.\n\n**Existing scaffolding to build on:**\n- `Platform` enum in `capture/detect.rs` (partially implemented, detects X11/Wayland/Windows)\n- `CaptureMode::Fullscreen`, `CaptureResult`, `CaptureMetadata` in `capture/mod.rs`\n- `ScreenshotResponse` struct in `commands/capture.rs` (has id, width, height, data_url)\n- Registered command: `take_screenshot(mode: String, monitor: Option\u003cu32\u003e)`\n\n**Acceptance criteria:**\n- Finish platform detection logic in `capture/detect.rs`\n- Implement xcap backend: `Monitor::all()` → composite into single `DynamicImage`\n- Create global image store as Tauri managed state: `Arc\u003cRwLock\u003cHashMap\u003cUuid, DynamicImage\u003e\u003e\u003e` — this is the shared store that OCR (fotos-hb0) and file-ops (fotos-ova) will also read from\n- Assign UUID v4, store image in global store\n- Implement `take_screenshot(\"fullscreen\", None)` → return `ScreenshotResponse { id, width, height, data_url }` (base64 PNG)\n- Emit `screenshot-ready` Tauri event with capture ID and dimensions\n- Frontend: PrtScn shortcut calls `takeScreenshot(\"fullscreen\")` via tauri-bridge, listens for event\n\n**Skip:** Portal/Wayland backend, monitor/region/window modes, delay, window enumeration.\n**Spec:** screenshot-capture (sections 2.1, 2.2 fullscreen only, 2.4, 2.5)","status":"open","priority":1,"issue_type":"task","owner":"charly.vibes@proton.me","created_at":"2026-02-19T21:06:54.976664986-03:00","created_by":"charly vibes","updated_at":"2026-02-19T21:51:31.35073089-03:00","dependencies":[{"issue_id":"fotos-1xi","depends_on_id":"fotos-1ia","type":"blocks","created_at":"2026-02-19T21:40:25.839487784-03:00","created_by":"charly vibes"}]}
{"id":"fotos-5yw","title":"Tracer: Settings — hardcoded defaults only","description":"Ensure all Tauri settings commands return sensible hardcoded defaults. No persistence or UI.\n\n**Existing scaffolding to build on:**\n- `Settings` struct with sub-structs already defined in `commands/settings.rs`: `CaptureSettings`, `AnnotationSettings`, `AiSettings`, `UiSettings`\n- `get_settings` / `set_settings` / `set_api_key` commands already registered in `lib.rs`\n- `credentials.rs` has fully implemented keyring functions (store/get/delete) — not needed for tracer but already done\n\n**Acceptance criteria:**\n- Implement `Default` for `Settings` (and each sub-struct) with these values:\n  - Capture: `default_mode: \"fullscreen\"`, `save_directory: \"~/Pictures/Fotos\"`, `default_format: \"png\"`, `jpeg_quality: 90`, `copy_to_clipboard_after_capture: true`, `include_mouse_cursor: false`, `delay_ms: 0`\n  - Annotation: `default_stroke_color: \"#FF0000\"`, `default_stroke_width: 2.0`, `default_font_size: 16.0`, `default_font_family: \"sans-serif\"`, `step_number_color: \"#FF0000\"`, `step_number_size: 24.0`, `blur_radius: 10.0`\n  - AI: `ocr_language: \"eng\"`, `default_llm_provider: \"claude\"`, `ollama_url: \"http://localhost:11434\"`, etc.\n  - UI: `theme: \"system\"`, `show_ai_panel: true`, `show_status_bar: true`\n- Implement `get_settings()` → return `Settings::default()`\n- `set_settings()` → no-op (return Ok) for tracer\n- `set_api_key()` → no-op (return Ok) for tracer\n\n**Skip:** tauri-plugin-store persistence, settings modal, schema versioning, actual keychain usage.\n**Spec:** settings-credentials (section 2.3 defaults only)","status":"open","priority":3,"issue_type":"task","owner":"charly.vibes@proton.me","created_at":"2026-02-19T21:07:20.778113665-03:00","created_by":"charly vibes","updated_at":"2026-02-19T21:52:22.511203996-03:00"}
{"id":"fotos-6p8","title":"Tracer: Annotation tools — rectangle tool only","description":"Implement a single annotation tool (rectangle) to prove the annotation data flow.\n\n**Existing scaffolding to build on:**\n- `Annotation` struct in `commands/files.rs` with fields: `id`, `annotation_type` (serde renamed from `type`), `x`, `y`, `width`, `height`, `stroke_color`, `stroke_width`, `opacity`, etc.\n- `tools.js` already has shortcuts map with `\"r\": \"rect\"`\n- `state.js` tracks `annotations` array, `strokeColor`, `strokeWidth`, `activeTool`\n- `canvas/engine.js` has `renderAnnotations()` and `renderActive()` stubs\n\n**Acceptance criteria:**\n- Press R to activate rect tool (existing toolbar.js shortcut wiring)\n- Mouse down on canvas → store start point in image coords (at 1:1 with no pan, screen coords == image coords — this assumption is intentional for the tracer and must be revisited when zoom/pan is added)\n- Mouse drag → call `engine.renderActive(previewRect)` on active canvas layer\n- Mouse up → create annotation object and push to `state.annotations`:\n  `{ id: crypto.randomUUID(), type: \"rect\", x, y, width, height, stroke_color: \"#FF0000\", stroke_width: 2 }`\n  **Note:** Use snake_case field names to match the Rust `Annotation` struct serde expectations, OR add `#[serde(rename_all = \"camelCase\")]` to the Rust struct. Pick one approach and be consistent.\n- Call `engine.renderAnnotations(state.annotations)` to redraw annotations layer\n- Implement rectangle drawing in `renderAnnotations()` and `renderActive()` (strokeRect with color/width)\n\n**Skip:** Other 8 tools, fill, style controls, z-ordering, locking, snapping.\n**Spec:** annotation-tools (sections 2.1 rect only, 2.2 data model minimal, 2.3 rendering)","status":"open","priority":1,"issue_type":"task","owner":"charly.vibes@proton.me","created_at":"2026-02-19T21:07:12.731492934-03:00","created_by":"charly vibes","updated_at":"2026-02-19T21:52:22.06213226-03:00","dependencies":[{"issue_id":"fotos-6p8","depends_on_id":"fotos-jub","type":"blocks","created_at":"2026-02-19T21:40:29.967050341-03:00","created_by":"charly vibes"}]}
{"id":"fotos-ae9","title":"Tracer: End-to-end smoke test","description":"Verify the complete tracer-bullet flow works end-to-end.\n\n**Acceptance criteria:**\nWalk through the full user journey and confirm each step works:\n1. App launches → UI shell renders toolbar + canvas + status bar, status shows 'Backend connected'\n2. PrtScn → screenshot captured → canvas shows the image → status shows dimensions\n3. R → rect tool active → draw rectangle on screenshot → annotation visible\n4. Click annotation → selected → Delete → gone → Ctrl+Z → restored\n5. OCR button → text extracted → displayed in AI panel\n6. Ctrl+S → composite saved to ~/Pictures/Fotos/ → status shows path\n\n**Test approach:** Manual walkthrough inside distrobox (`just dev`). Document any issues found as new beads tickets.\n\n**All tracer tickets must be complete before this can start.**","status":"open","priority":2,"issue_type":"task","owner":"charly.vibes@proton.me","created_at":"2026-02-19T21:07:21.070889826-03:00","created_by":"charly vibes","updated_at":"2026-02-19T21:07:21.070889826-03:00","dependencies":[{"issue_id":"fotos-ae9","depends_on_id":"fotos-1ia","type":"blocks","created_at":"2026-02-19T21:40:32.708685036-03:00","created_by":"charly vibes"},{"issue_id":"fotos-ae9","depends_on_id":"fotos-1xi","type":"blocks","created_at":"2026-02-19T21:40:32.747634123-03:00","created_by":"charly vibes"},{"issue_id":"fotos-ae9","depends_on_id":"fotos-jub","type":"blocks","created_at":"2026-02-19T21:40:32.782490759-03:00","created_by":"charly vibes"},{"issue_id":"fotos-ae9","depends_on_id":"fotos-kri","type":"blocks","created_at":"2026-02-19T21:40:32.819886859-03:00","created_by":"charly vibes"},{"issue_id":"fotos-ae9","depends_on_id":"fotos-6p8","type":"blocks","created_at":"2026-02-19T21:40:32.856504226-03:00","created_by":"charly vibes"},{"issue_id":"fotos-ae9","depends_on_id":"fotos-clp","type":"blocks","created_at":"2026-02-19T21:40:32.889160888-03:00","created_by":"charly vibes"},{"issue_id":"fotos-ae9","depends_on_id":"fotos-hb0","type":"blocks","created_at":"2026-02-19T21:40:32.925729911-03:00","created_by":"charly vibes"},{"issue_id":"fotos-ae9","depends_on_id":"fotos-ova","type":"blocks","created_at":"2026-02-19T21:40:32.961461617-03:00","created_by":"charly vibes"},{"issue_id":"fotos-ae9","depends_on_id":"fotos-5yw","type":"blocks","created_at":"2026-02-19T21:40:32.9972123-03:00","created_by":"charly vibes"}]}
{"id":"fotos-clp","title":"Tracer: Selection \u0026 history — delete + undo via command pattern","description":"Prove the command pattern for undo/redo with the simplest operation: delete annotation.\n\n**Existing scaffolding to build on:**\n- `History` class in `canvas/history.js` already has working `execute(command, annotations)`, `undo(annotations)`, `redo(annotations)` logic with `#maxSize = 100`\n- `SelectionManager` in `canvas/selection.js` has `select()`, `deselect()`, `hitTest()` stubs\n- `state.js` tracks `undoStack`, `redoStack`\n- `pointInRect()` helper exists in `utils/geometry.js`\n\n**Acceptance criteria:**\n- Implement `SelectionManager.hitTest(x, y, annotations)`: check if point is inside any rect annotation bounds (use `pointInRect` from utils/geometry.js)\n- Click on canvas → hit-test → if annotation found, select it (dashed border or resize handles as visual indicator)\n- Create `DeleteCommand` class: `{ execute(annotations) → splice annotation out, return delta; undo(annotations) → splice annotation back in }`\n  Clarification: \"deltas not snapshots\" means store the deleted annotation object as the delta, NOT a snapshot of the entire annotations array. The deleted annotation is the delta.\n- Press Delete → create DeleteCommand → pass to `history.execute()` → re-render\n- Ctrl+Z → `history.undo()` → restores the deleted annotation → re-render\n- Wire shortcuts: Delete and Ctrl+Z (owned by this ticket, not UI shell)\n\n**Skip:** Move/resize, select-all, redo, multi-select, history size limits, Shift/Ctrl click.\n**Spec:** selection-history (sections 2.1 select, 2.2 delete only, 2.3 command pattern, 2.4 undo only)","status":"open","priority":1,"issue_type":"task","owner":"charly.vibes@proton.me","created_at":"2026-02-19T21:07:14.66872994-03:00","created_by":"charly vibes","updated_at":"2026-02-19T21:52:22.174577916-03:00","dependencies":[{"issue_id":"fotos-clp","depends_on_id":"fotos-6p8","type":"blocks","created_at":"2026-02-19T21:40:30.004043408-03:00","created_by":"charly vibes"}]}
{"id":"fotos-cqg","title":"Tracer: MCP server — stub binary that exits cleanly","description":"Minimal MCP server stub to prove the binary builds and can be invoked.\n\n**Acceptance criteria:**\n- fotos-mcp binary starts, prints version to stderr, exits 0\n- No JSON-RPC handling, no IPC bridge, no tools/resources/prompts\n- Binary compiles and is included in build output\n- Just enough to confirm the workspace member builds alongside the main app\n\n**Skip:** Entire MCP protocol, stdio transport, IPC bridge, tools, resources, prompts, standalone mode.\n**Spec:** mcp-server (deferred — prove binary builds only)","status":"open","priority":4,"issue_type":"task","owner":"charly.vibes@proton.me","created_at":"2026-02-19T21:07:20.922633383-03:00","created_by":"charly vibes","updated_at":"2026-02-19T21:07:20.922633383-03:00"}
{"id":"fotos-hb0","title":"Tracer: AI processing — OCR via Tesseract","description":"Minimal AI pipeline: extract text from screenshot using Tesseract OCR.\n\n**Existing scaffolding to build on:**\n- Registered command: `run_ocr(image_id: String, lang: Option\u003cString\u003e)` in `commands/ai.rs`\n- `OcrResult` struct: `{ text: String, regions: Vec\u003cOcrRegion\u003e }` already defined\n- `tauri-bridge.js` already has `runOcr(imageId, lang)` wrapper\n- tessdata bundled via tauri.conf.json: `resources/tessdata/*`\n- Global image store (created in fotos-1xi) provides `HashMap\u003cUuid, DynamicImage\u003e`\n\n**Acceptance criteria:**\n- Implement `run_ocr`: look up `image_id` in global image store, error if not found\n- Convert `DynamicImage` to format tesseract-rs expects (grayscale or RGB bytes)\n- Run OCR with `resources/tessdata/eng.traineddata` (resolve path via Tauri resource resolver)\n- Return `OcrResult { text: \u003cextracted\u003e, regions: vec![] }` (skip per-word bounding boxes for tracer; return empty regions vec)\n- Frontend: OCR toolbar button calls `runOcr(state.currentImageId)`, displays `result.text` in `#ocr-results` panel\n- Status bar: show \"Running OCR...\" during processing, \"OCR complete\" on success, error message on failure\n- Wire OCR toolbar button shortcut (owned by this ticket)\n\n**Skip:** Per-word bounding boxes/regions, PII detection, auto-blur, LLM providers, timeout handling, image resizing.\n**Spec:** ai-processing (section 2.1 OCR only)","status":"open","priority":1,"issue_type":"task","owner":"charly.vibes@proton.me","created_at":"2026-02-19T21:07:20.483957396-03:00","created_by":"charly vibes","updated_at":"2026-02-19T21:52:22.284456347-03:00","dependencies":[{"issue_id":"fotos-hb0","depends_on_id":"fotos-1ia","type":"blocks","created_at":"2026-02-19T21:40:25.946744161-03:00","created_by":"charly vibes"},{"issue_id":"fotos-hb0","depends_on_id":"fotos-1xi","type":"blocks","created_at":"2026-02-19T21:40:30.039184647-03:00","created_by":"charly vibes"}]}
{"id":"fotos-jub","title":"Tracer: Canvas engine — load image and render base layer","description":"Minimal canvas rendering: load a captured image and draw it to the base canvas.\n\n**Existing scaffolding to build on:**\n- `CanvasEngine` class in `canvas/engine.js` with constructor taking `(baseCanvas, annoCanvas, activeCanvas)` and all method stubs\n- `state.js` already tracks `zoom`, `panX`, `panY`, `currentImageId`, `annotations`\n- Three stacked canvases in HTML: `#canvas-base`, `#canvas-annotations`, `#canvas-active`\n\n**Acceptance criteria:**\n- Implement `loadImage(dataUrl)`: create `ImageBitmap` from base64 data URL, store reference\n- Implement `renderBase()`: clear canvas, `drawImage` at 1:1 scale (no transform)\n- Size all 3 canvas layers to fit container (maintain aspect ratio)\n- Update `state.currentImageId` and display dimensions in `#status-dimensions` (e.g. \"1920×1080\")\n- Canvas clears and redraws on new image load\n\n**Skip:** Zoom/pan, `screenToImage()` transforms, HiDPI/DPR handling, export composite, triple-layer optimization.\n**Spec:** canvas-engine (sections 2.1 base layer only, 2.2 load only, 2.6 sizing)","status":"open","priority":1,"issue_type":"task","owner":"charly.vibes@proton.me","created_at":"2026-02-19T21:06:58.640935848-03:00","created_by":"charly vibes","updated_at":"2026-02-19T21:51:33.662475432-03:00","dependencies":[{"issue_id":"fotos-jub","depends_on_id":"fotos-1ia","type":"blocks","created_at":"2026-02-19T21:40:25.876536128-03:00","created_by":"charly vibes"},{"issue_id":"fotos-jub","depends_on_id":"fotos-1xi","type":"blocks","created_at":"2026-02-19T21:40:29.931697681-03:00","created_by":"charly vibes"}]}
{"id":"fotos-kri","title":"Tracer: UI shell — toolbar, status bar, keyboard shortcuts","description":"Wire up the existing HTML scaffold for toolbar chrome and status bar display. Each feature ticket owns its own keyboard shortcuts — this ticket only handles UI presentation.\n\n**Existing scaffolding to build on:**\n- `toolbar.js` already wires `data-tool` button clicks to `store.set(\"activeTool\", ...)` with active tool highlighting\n- `ai-panel.js` already implements collapse toggle\n- All HTML elements exist: `#toolbar`, `#statusbar`, `#ai-panel`, all `data-tool` and `data-action` buttons\n- `state.js` pub/sub pattern already works\n\n**Acceptance criteria:**\n- Ensure toolbar buttons visually respond: Capture, Rectangle, OCR, Save highlight on hover/click\n- Active tool indicator: accent-colored background on selected `data-tool` button (verify existing toolbar.js does this correctly)\n- Status bar wiring: `#status-dimensions` shows image size, `#status-tool` shows active tool name, `#status-message` shows transient messages (auto-clear after 4s)\n- AI results panel: verify existing toggle works, show OCR text when available\n- Wire `data-action` buttons to dispatch events that feature modules listen for (capture-region/fullscreen, ocr, save) — but the actual handlers live in their respective feature tickets\n\n**Not owned by this ticket (owned by feature tickets):**\n- PrtScn shortcut → fotos-1xi (capture)\n- R shortcut → fotos-6p8 (annotations)\n- Delete, Ctrl+Z → fotos-clp (selection/history)\n- Ctrl+S → fotos-ova (file-ops)\n\n**Skip:** Color/size pickers, theme system, settings modal, export dialog, accessibility attributes.\n**Spec:** ui-shell (sections 2.1 toolbar, 2.5 status bar — presentation only)","status":"open","priority":1,"issue_type":"task","owner":"charly.vibes@proton.me","created_at":"2026-02-19T21:07:01.822448999-03:00","created_by":"charly vibes","updated_at":"2026-02-19T21:52:21.949707774-03:00","dependencies":[{"issue_id":"fotos-kri","depends_on_id":"fotos-1ia","type":"blocks","created_at":"2026-02-19T21:40:25.908136318-03:00","created_by":"charly vibes"}]}
{"id":"fotos-ova","title":"Tracer: File operations — save composite PNG","description":"Save a composited screenshot+annotations as a PNG file.\n\n**Existing scaffolding to build on:**\n- Registered command: `save_image(image_id: String, annotations: Vec\u003cAnnotation\u003e, format: String, path: String)` in `commands/files.rs`\n- `Annotation` struct already defined in `files.rs`\n- `tauri-bridge.js` has `saveImage(imageId, annotations, format, path)` wrapper\n- `directories` crate in Cargo.toml for resolving `~/Pictures`\n- `image` + `imageproc` + `ab_glyph` crates available for compositing\n- Global image store (created in fotos-1xi) provides base image\n\n**Acceptance criteria:**\n- Implement `save_image`: look up image in global store, composite annotations onto a clone using `imageproc` (draw rectangles with stroke color/width)\n- For tracer: if `path` is empty string, construct default path: `~/Pictures/Fotos/fotos-YYYYMMDD-HHMMSS.png` using `directories::UserDirs` + `chrono`\n- Create `~/Pictures/Fotos/` directory if it doesn't exist (`std::fs::create_dir_all`)\n- Save as PNG, return saved file path as String\n- Frontend: Ctrl+S calls `saveImage(state.currentImageId, state.annotations, \"png\", \"\")` — empty path triggers default\n- Status bar shows saved path on success, error message on failure\n- Wire Ctrl+S shortcut (owned by this ticket, not UI shell)\n\n**Skip:** Save-as dialog, clipboard copy, export annotations JSON, load image, JPEG/WebP formats, quality settings, auto-copy.\n**Spec:** file-operations (sections 2.1 save_image, 2.4 default directory)","status":"open","priority":1,"issue_type":"task","owner":"charly.vibes@proton.me","created_at":"2026-02-19T21:07:20.632636675-03:00","created_by":"charly vibes","updated_at":"2026-02-19T21:52:22.398422066-03:00","dependencies":[{"issue_id":"fotos-ova","depends_on_id":"fotos-1ia","type":"blocks","created_at":"2026-02-19T21:40:25.9836866-03:00","created_by":"charly vibes"},{"issue_id":"fotos-ova","depends_on_id":"fotos-jub","type":"blocks","created_at":"2026-02-19T21:40:30.076154419-03:00","created_by":"charly vibes"},{"issue_id":"fotos-ova","depends_on_id":"fotos-6p8","type":"blocks","created_at":"2026-02-19T21:40:30.113621496-03:00","created_by":"charly vibes"},{"issue_id":"fotos-ova","depends_on_id":"fotos-5yw","type":"blocks","created_at":"2026-02-19T21:52:26.154226647-03:00","created_by":"charly vibes"}]}
